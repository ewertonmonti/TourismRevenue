---
title: "Tourism revenue in Brazil"
author: "Ewerton Monti"
date: "25 de julho de 2017"
output: ioslides_presentation
---

```{r echo=FALSE, warning=FALSE, message=FALSE}
fileAddress <- "C:/Users/Ewerton/Dropbox/Curso_Data_Science/9_DataProducts/Week3/receita_turismo/receita_turismo.csv"
origData <- read.table(fileAddress, sep = ";", header = TRUE, 
                       colClasses = c("character", "numeric", "numeric", "numeric", "numeric", "character"))
```

## Introduction

The objective of this plot is to show the most important countries for tourism revenue in Brazil.

The size of the circles represent the total amount of revenue generated by tourists of each country in Brazil (the most relevant countries). Here, tourism revenue is the result of the multiplication of average daily expenditure per tourist in Brazil (y-axis of the plot), average length of stay in Brazil (x-axis of the plot) and number of tourists in Brazil - all data from 2016.

Tourists from South America spent less money and made shorter stays in Brazil, compared to Europeans for example, but the amount of revenue they create is larger due to the number of tourists from those countries.

The plot was made using the plotly package.

## Table

The tablet below shows the first ten countries in tourism revenue in Brazil.

```{r warning=FALSE, message=FALSE}
head(origData[order(-origData$revenue),1:6], n = 10)
```

## The plot
```{r echo=FALSE, message=FALSE, warning=FALSE} 
# Formating data for hovers
origData$revenue_format <- format(origData$revenue, 
                                  decimal.mark = ",", big.mark = " ")
origData$tourists_format <- format(origData$tourists,
                                   decimal.mark = ",", big.mark = " ")

# Data for annotations
argentina <- origData[origData$country=="Argentina",]
usa <- origData[origData$country=="United States",]

# Plot
library(plotly)
plot_ly(data = origData, 
        x = ~stay, 
        y = ~expenditure, 
        type = 'scatter',
        mode = 'markers',
        size = ~revenue,
        marker = list(sizeref = .05),
        color = ~region,
        colors = "Spectral",
        text = ~paste("Country: ", country, 
                      "<br>Tourists: ", tourists_format, 
                      '<br>Revenue: $', revenue_format, 
                      '<br>Average expenditure: $', expenditure, 
                      '<br>Average stay: ', stay, ' nights')
) %>%
    layout(
        title = 'Tourism in Brazil: total revenue, average expenditure and length of stay by country of origin',
        xaxis = list(title = "Average length of stay (nights)"),
        yaxis = list(title = "Average daily expenditure  per person (US$)")) %>%
    add_annotations(
        x = argentina$stay,
        y = argentina$expenditure,
        text = "Argentina creates<br>more revenue",
        xref = "x",
        yref = "y",
        showarrow = TRUE,
        arrowhead = 7,
        ax = -20,
        ay = -45) %>%
    add_annotations(
        x = usa$stay,
        y = usa$expenditure,
        text = "United States is the second in revenue creation",
        xref = "x",
        yref = "y",
        showarrow = TRUE,
        arrowhead = 7,
        ax = 20,
        ay = -45)
```
